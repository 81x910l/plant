* Rcpp error handling

Should not do Rf_error(), as that longjmp's over destructors.  Use
Rcpp::error instead.

* Exporting utility functions

Convert remaining utility functions to use Rcpp::function.
